% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/big_factorise.R
\name{big_factorise}
\alias{big_factorise}
\title{Factorize Angle Matrices into Z-Scores}
\usage{
big_factorise(x_mat, method = "pearson", seed = 1)
}
\arguments{
\item{x_mat}{A \code{\link[bigstatsr]{FBM}} object representing the
normalized and scaled gene expression matrix.}

\item{method}{A character string specifying the method for calculating the
relationship between gene pairs. Default is \code{"pearson"}. Other options
include \code{"spearman"} and \code{"diem"} (see
\url{https://bytez.com/docs/arxiv/2407.08623/paper}).}

\item{seed}{An integer value for setting the seed for reproducibility during
permutation. Default is \code{1}.}
}
\value{
An \code{\link[bigstatsr]{FBM}} object containing the
z-score-transformed angle matrix.
}
\description{
\code{big_factorise} computes the angle matrix of the input gene expression
matrix using the specified method, performs permutation to create a null
distribution, and transforms the correlations into z-scores. This function
is optimized for large datasets using the \pkg{bigstatsr} package.
}
\details{
The function performs the following steps:
\enumerate{
\item \strong{Permutation}: The input matrix is permuted column-wise to disrupt
existing angles, creating a null distribution.
\item \strong{Angle Computation}: Computes the angle matrix for both the
original and permuted matrices using \code{\link{big_extract_corr}}.
\item \strong{Method-Specific Processing}:
\itemize{
\item If \code{method = "diem"}, computes Euclidean distances and scales
the angles accordingly, based on the methodology from the DIEM
algorithm (\url{https://bytez.com/docs/arxiv/2407.08623/paper}).
\item For other methods (\code{"pearson"}, \code{"spearman"}),
statistical measures are computed from the permuted data.
}
\item \strong{Statistical Measures}: Calculates mean, variance, and standard
deviation using \code{\link{get_dstat}}.
\item \strong{Z-Score Transformation}: Transforms the original angle matrix into
z-scores.
}
This process allows for the identification of invariant gene-gene
relationships by comparing them to a null distribution derived from the
permuted data.
}
\seealso{
\code{\link{big_extract_corr}},
\code{\link{get_dstat}},
\code{\link[bigstatsr]{big_apply}},
\code{\link[bigstatsr]{FBM}}
}
